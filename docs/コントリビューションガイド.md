# コントリビューションガイド

## はじめに

Shift Editorプロジェクトへの貢献を検討していただき、ありがとうございます。このガイドは、プロジェクトへの効果的な貢献方法を説明するものです。

> 本番環境は **OCI** にあり、ローカル開発では **Docker Compose** を使用します。Pull Request のプレビューは Vercel で自動生成される場合がありますが必須ではありません。

## 開発環境のセットアップ

1. リポジトリをクローンします:
```bash
git clone https://github.com/yourorganization/shift-editor.git
cd shift-editor
```

2. 依存関係をインストールします:
```bash
npm install
```

3. 環境変数を設定します:
```bash
cp .env.example .env.local
```
`.env.local` ファイルを編集し、必要な環境変数を設定します。

4. データベースをセットアップします:
```bash
npx prisma migrate dev
```

5. 開発サーバーを起動します:
```bash
npm run dev
```

## Docker開発環境の利用手順

### 環境の起動と停止

1. 開発環境を起動します:
```bash
./scripts/docker-dev.sh up
```
   
2. 開発環境を停止します:
```bash
./scripts/docker-dev.sh down
```

3. 環境を再起動します:
```bash
./scripts/docker-dev.sh restart
```

### Cursor上での開発手順

1. **ボリュームマウント**
   - ローカルのファイル変更はコンテナ内の`/app`ディレクトリに自動的に反映されます
   - Cursorでファイルを編集すると、Next.jsの開発サーバーが変更を検知して自動的に再ビルドします

2. **コンテナ内でのコマンド実行**
```bash
# パッケージインストール
./scripts/docker-dev.sh exec npm install <パッケージ名>

# マイグレーション実行
./scripts/docker-dev.sh migrate

# その他のコマンド実行
./scripts/docker-dev.sh exec <コマンド>
```

3. **データベースアクセス**
```bash
# データベースシェルにアクセス
./scripts/docker-dev.sh db-shell
```

4. **ログの確認**
```bash
# アプリケーションのログを確認
./scripts/docker-dev.sh logs
```

5. **デバッグ**
   - ブラウザのDevToolsを使用してフロントエンドのデバッグ
   - コンテナログの確認でバックエンドの問題を特定
   - 問題発生時は環境の再起動を試行

## コード規約

### 一般的なガイドライン

- TypeScriptを使用し、厳格な型チェックを有効にしてください
- 関数やクラスには適切なJSDocコメントを追加してください
- コードの可読性を優先し、過度に簡潔なコードは避けてください
- テストが容易なコードを書いてください

### スタイルガイド

- ESLintとPrettierの設定に従ってください
- コンポーネントはアトミックデザインの原則に従って構成してください
- CSSはTailwind CSSを使用し、必要に応じてカスタムクラスを定義してください

### コミットメッセージ

以下の接頭辞を使用してコミットの種類を示してください:

- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの意味に影響しない変更（スペース、フォーマットなど）
- `refactor`: バグ修正でも機能追加でもないコード変更
- `perf`: パフォーマンスを向上させるコード変更
- `test`: テストの追加・修正
- `chore`: ビルドプロセスやツールの変更

例: `feat: シフト希望提出機能の追加`

## ブランチ戦略

- `main`: 本番環境用のブランチです。直接コミットしないでください
- `develop`: 開発用の統合ブランチです
- `feature/xxx`: 新機能開発用のブランチです
- `fix/xxx`: バグ修正用のブランチです
- `release/x.x.x`: リリース準備用のブランチです

基本的なワークフロー:
1. `develop`ブランチから新しいfeatureブランチを作成
2. 機能を実装
3. `develop`ブランチにプルリクエストを作成
4. レビューと承認後、マージ

## プルリクエスト

プルリクエストを作成する際には以下のガイドラインに従ってください:

1. プルリクエストのタイトルは明確かつ簡潔に
2. 変更内容、目的、影響範囲を詳細に説明
3. 関連する課題（Issue）があれば参照
4. スクリーンショットや動画があれば添付（UIの変更がある場合）

## コードレビュー

- すべてのプルリクエストは少なくとも1人のレビュアーによる承認が必要です
- レビューコメントは建設的かつ丁寧に行ってください
- コードスタイル、パフォーマンス、セキュリティ、テストカバレッジに特に注意してレビューしてください

## テスト

- 新機能には対応するテストを追加してください
- 既存のテストが壊れていないことを確認してください
- テストカバレッジは80%以上を目標としてください

## ドキュメント

- APIの変更があった場合は、APIドキュメントを更新してください
- 新しいコンポーネントを追加した場合は、Storybookを更新してください
- 重要な機能変更がある場合は、ユーザーマニュアルを更新してください

## 質問やサポート

質問やサポートが必要な場合は、以下の方法で連絡してください:

- Issueを作成する
- プロジェクトのSlackチャンネルで質問する
- 緊急の場合はプロジェクト管理者に直接連絡する

ご協力ありがとうございます！ 